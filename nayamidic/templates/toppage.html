{% extends 'templates/base.html' %}
<body>
    {% block content %}
    <div class="post_margin">
    {% for items in post_list %}
        {% for item in items %}
        <div class="card container  p-30 d-fle justify-content-center" style="width: 18rem;">
            <div class="card-body">
                <p><a href="{% url 'user_detail' pk=item.user.id %}">{{ item.user.username }}</a></p>
                <h5 class="card-title">{{ item.categories }}</h5>
                <p class="card-text">{{ item.text }} {% include 'templates/like.html' %}</p>
            </div>
        </div>
        {% endfor %}
        {% endfor %}
    </div>
        <input id="like" type="button" value="button" onclick="buttonClick()">
    <script>
        $(document).ready(function(event){
            $(document).on('click', '#like', function(event){
                let post_id = $(this).attr('name')
                event.preventDefault();
                console.log(post_id)
                $.ajax({
                    type: 'POST',
                    url: "{% url 'like' %}" ,
                    data: {
                        'post_id': $(this).attr('name'),
                        'csrfmiddlewaretoken': '{{ csrf_token }}'},
                        dataType: 'json',
                        success: function(response){
                            selector2 = document.getElementsByName(response.post_id + "count");
                            $(selector2).text(response.like_count);
                        }
                    });
                });
            });
            </script>
        {% endblock content %}
        </body>